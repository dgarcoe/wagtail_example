{% extends "base.html" %}
{% load static wagtailcore_tags wagtailimages_tags %}

{% block body_class %}template-blogindex{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/blog.css' %}">
{% endblock %}

{% block content %}
<div class="blog-header">
    <div class="container">
        <h1>{{ page.title }}</h1>
        {% if page.intro %}
        <div class="blog-intro rich-text">{{ page.intro|richtext }}</div>
        {% endif %}
        {% if current_tag %}
        <p class="blog-tag-filter">
            Filtered by tag: <strong>{{ current_tag }}</strong>
            &mdash; <a href="{% pageurl page %}">Show all posts</a>
        </p>
        {% endif %}
    </div>
</div>

<div class="container">
    <div class="blog-list">
        {% for post in posts %}
        <article class="blog-card">
            {% if post.header_image %}
            <a href="{% pageurl post %}" class="blog-card-image">
                {% image post.header_image fill-600x300 as post_img %}
                <img src="{{ post_img.url }}" alt="{{ post.title }}">
            </a>
            {% endif %}
            <div class="blog-card-body">
                <time class="blog-card-date" datetime="{{ post.date|date:'Y-m-d' }}">
                    {{ post.date|date:"F j, Y" }}
                </time>
                <h2 class="blog-card-title">
                    <a href="{% pageurl post %}">{{ post.title }}</a>
                </h2>
                <p class="blog-card-intro">{{ post.intro }}</p>
                {% if post.tags.all %}
                <div class="blog-card-tags">
                    {% for tag in post.tags.all %}
                    <a href="{% pageurl page %}?tag={{ tag }}" class="blog-tag">{{ tag }}</a>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </article>
        {% empty %}
        <p class="blog-empty">No posts yet. Check back soon!</p>
        {% endfor %}
    </div>

    <div class="blog-back">
        <a href="{% pageurl page.get_parent %}">&larr; Back to home</a>
    </div>
</div>
{% endblock %}
