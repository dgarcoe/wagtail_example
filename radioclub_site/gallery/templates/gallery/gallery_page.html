{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block title %}{{ page.title }}{% endblock %}

{% block content %}
<div class="container py-5">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Inicio</a></li>
            {% for ancestor in page.get_ancestors.specific %}
            {% if not ancestor.is_root %}
            <li class="breadcrumb-item"><a href="{% pageurl ancestor %}">{{ ancestor.title }}</a></li>
            {% endif %}
            {% endfor %}
            <li class="breadcrumb-item active">{{ page.title }}</li>
        </ol>
    </nav>

    <h1 class="mb-2">{{ page.title }}</h1>
    {% if page.date %}<p class="text-muted">{{ page.date }}</p>{% endif %}
    {% if page.introduction %}<p class="lead mb-4">{{ page.introduction }}</p>{% endif %}

    <div class="row g-3">
        {% for item in page.gallery_images.all %}
        <div class="col-6 col-md-4 col-lg-3">
            <a href="#" class="d-block" data-bs-toggle="modal" data-bs-target="#imageModal{{ forloop.counter }}">
                {% image item.image fill-300x300 as thumb %}
                <img src="{{ thumb.url }}" class="img-fluid rounded shadow-sm" alt="{{ item.caption|default:page.title }}">
            </a>
            {% if item.caption %}<p class="small text-muted mt-1">{{ item.caption }}</p>{% endif %}
        </div>

        <!-- Modal for full image -->
        <div class="modal fade" id="imageModal{{ forloop.counter }}" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content bg-transparent border-0">
                    <div class="modal-body p-0 text-center">
                        {% image item.image width-1200 as full_img %}
                        <img src="{{ full_img.url }}" class="img-fluid rounded" alt="{{ item.caption|default:page.title }}">
                        {% if item.caption %}
                        <p class="text-white mt-2">{{ item.caption }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
